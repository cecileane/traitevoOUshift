Bug detection and fix process

2016-07-28 Bug: There were many false-positives close to root and shift edges. Also, the mean of some contrasts were not zero.
Reason for the bug:the bug was due to mean “mu” that helped to centralize the contrasts was wrongly calculated in the function “estimate_shift_configuration." Instead, ‘mu’ should be the optimal value at the tips instead of the expected value.. In our situation, we also considered that the alpha we used in this model was not or even close to the true alpha. So, we added one more run of LASSO to optimize further the alpha value, which may generate some different candidate models.

The two non-shift edges that had significantly high bootstrap support were not detected as shift edges, meaning the bug was due to the incorrect alpha value.
2016-08-25 Fixed the bug. From version 1.24 to 1.25

2016-09-01 Bug:  we set theta (the optimal value) to be one-fourth of the original value. The error happened when l1ou chose a model with only one shift as the best model. With original theta, it never happened to choose a model with one shift. But it became possible when we reduced the theta values. 
Reason for the bug: if we selected the S columns in which contained many selected columns we needed from the matrix M, we could not guarantee S was not empty in this case. So, we replaced M[, S] by as.matrix( M[, S] ) to avoid the error thrown because of the empty set S. 
2016-09-02 Fixed the bug. From version 1.25 to 1.26

2016-09-14 remove run.list in sequential case to use less memory                From version 1.26 to 1.27

2016-09-02
I found a bug in package `l1ou` version 1.27. There was a bug due to the function `normalized_tree`. For the tree has a root edge, the root edge was not used in the funtion. In addition, the distance from the root to all tips did not include the length of the root.edge. Due to this bug, the square root of the covariance matrix generated by the two models (OUrandomRoot and OUfixedRoot) are the same except for the last column which is the covariance of the root with other edges. 

2016-09-22  Fixed the bug. From version 1.27 to 1.28.
Now, the bug has been fixed and the square root of the covariance matrix generated by the two models are different. 
See the full report as a webpage, please go to

https://yuqing19118.github.io/testing_variance.html






This repository is used for checking the distribution of phylogenetic contrasts that are used in the bootstrap procedure in the 
`l1ou` package. We found that for some nodes, the contrasts' mean was far away from zero. (Problem has been fixed)
We found the same variance for contrasts on all nodes, but with an unexpected value. The expected value should be sigma2. (Problem has not been saved)

Here is the summary of report I have worked on to find out the problem mentioned above.
---------------------------------------------------------------------------------------------------------------

2016-09-04 Version 1.28
https://yuqing19118.github.io/contrast_dist2016_08_22.html

2016-07-24 Version 1.24
https://github.com/yuqing19118/traitevoOUshift/blob/master/contrast/contrast_dist.pdf

